<!DOCTYPE html>    
<html lang="bn">    
<head>    
    <meta charset="UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <title>üöÄ ‡¶ü‡ßá‡¶ï ‡¶ü‡¶æ‡¶á‡¶ó‡¶æ‡¶∞ - ‡¶ì‡ßü‡ßá‡¶¨ ‡¶ï‡¶®‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶ï üòà</title>    
    <style>    
        body { font-family: Arial, sans-serif; background-color: #f0f4f8; text-align: center; padding: 20px; }    
        #response { background-color: #d4edda; padding: 10px; border-radius: 5px; margin-top: 20px; display: none; font-size: 18px; color: #155724; }    
        button { background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; margin: 5px; }    
        button:hover { background-color: #0056b3; }    
        #loading { display: none; font-size: 18px; color: #ff0000; }    
    </style>    
</head>    
<body>    
    
    <h1>üöÄ ‡¶ü‡ßá‡¶ï ‡¶ü‡¶æ‡¶á‡¶ó‡¶æ‡¶∞ - ‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡ßã‡¶§‡ßç‡¶§‡¶∞ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ üòà</h1>    
    <button onclick="startListening()">üé§ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞</button>    
    <button onclick="stopSpeaking()">üõë ‡¶∏‡ßç‡¶ü‡¶™</button>    
    <br><br>    
    <div id="loading">üîé ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>    
    <div id="response"></div>    
    
    <script>    
        let recognition;    
        let speechSynthesis = window.speechSynthesis;    
        let utterance;    
        let listening = false;  // ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ó ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤  
  
        function setupRecognition() {    
            recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();    
            recognition.lang = 'bn-BD';    
            recognition.continuous = false;    
            recognition.interimResults = false;    
            recognition.onresult = async function(event) {    
                processSpeech(event.results[0][0].transcript);    
            };    
            recognition.onerror = function(event) {    
                showError();    
            };    
        }    
    
        function startListening() {    
            if (!recognition) { setupRecognition(); }    
            if (listening) return;  // ‡¶Ø‡¶¶‡¶ø ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∂‡ßÅ‡¶®‡¶õ‡ßá, ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶á ‡¶®‡¶æ ‡¶ï‡¶∞‡ßã    
            document.getElementById('loading').style.display = 'block';    
            recognition.start();    
            listening = true;    
        }    
  
        function stopSpeaking() {    
            if (speechSynthesis.speaking) {    
                speechSynthesis.cancel();    
            }  
            if (recognition) {    
                recognition.stop();  // ‡¶Æ‡¶æ‡¶á‡¶ï‡ßç‡¶∞‡ßã‡¶´‡ßã‡¶® ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ    
            }  
            listening = false;    
        }    
  
        async function processSpeech(query) {    
            document.getElementById('loading').style.display = 'none';    
            document.getElementById('response').style.display = 'block';    
            document.getElementById('response').innerHTML = `‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶¨‡¶≤‡ßá‡¶õ‡ßã: <strong>${query}</strong><br>üîé ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶ñ‡ßã‡¶Å‡¶ú‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...`;    

            let answer = await fetchFromLocal(query);    

            document.getElementById('response').innerHTML = `<strong>‡¶â‡¶§‡ßç‡¶§‡¶∞:</strong> ${answer}`;    
            speakAnswer(answer);    

            // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Æ‡¶æ‡¶á‡¶ï‡ßç‡¶∞‡ßã‡¶´‡ßã‡¶® ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá
            if (recognition) {    
                recognition.stop();  // ‡¶Æ‡¶æ‡¶á‡¶ï‡ßç‡¶∞‡ßã‡¶´‡ßã‡¶® ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶æ
            }  
            listening = false; // ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡ßü ‡¶∂‡ßÅ‡¶®‡¶õ‡ßá ‡¶®‡¶æ
        }    
    
        function showError() {    
            document.getElementById('loading').style.display = 'none';    
            document.getElementById('response').style.display = 'block';    
            document.getElementById('response').innerHTML = '‚ùå ‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®!';    
        }    
    
        async function fetchFromLocal(query) {    
            try {    
                let response = await fetch('https://raw.githubusercontent.com/Hacker22155/kaku/main/data.txt');    
                let data = await response.text();    
                let answer = extractAnswerFromText(data, query);    
                    
                if (answer) {    
                    return answer;    
                } else {    
                    return "‚ùå ‡¶ï‡¶ø‡¶õ‡ßÅ‡¶á ‡¶™‡¶æ‡¶á‡¶®‡¶ø!";    
                }    
            } catch (error) {    
                return '‚ùå ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®!';    
            }    
        }    
    
        function extractAnswerFromText(data, query) {    
            let lines = data.split('\n');    
            for (let line of lines) {    
                if (line.toLowerCase().includes(query.toLowerCase())) {    
                    return line; // ‡¶´‡¶æ‡¶á‡¶≤ ‡¶•‡ßá‡¶ï‡ßá ‡¶Æ‡ßá‡¶≤‡ßá ‡¶è‡¶Æ‡¶® ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡¶ø‡¶¨‡ßá    
                }    
            }    
            return null;    
        }    
    
        function speakAnswer(answer) {    
            utterance = new SpeechSynthesisUtterance(answer);    
            utterance.lang = 'bn-BD';    
            utterance.rate = 1.2;  // ‡¶∏‡ßç‡¶™‡¶ø‡¶° ‡¶¨‡¶æ‡ßú‡¶ø‡ßü‡ßá ‡¶¶‡¶ø‡¶≤‡¶æ‡¶Æ üî•    
            speechSynthesis.speak(utterance);    
        }    
    </script>    
    
</body>    
  </html>
